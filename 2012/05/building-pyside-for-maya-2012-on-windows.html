<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=author content><title>Building PySide for Maya 2012 on Windows</title><link href=http://shihchinw.github.io/css/bootstrap.css rel=stylesheet><link href=http://shihchinw.github.io/css/clean-blog.css rel=stylesheet><link href=//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css rel=stylesheet type=text/css><link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel=stylesheet type=text/css><link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel=stylesheet type=text/css><link href='//fonts.googleapis.com/css?family=Lato:400,400italic|Open+Sans:400italic,600italic,400,600|Coda:800)' media=screen rel=stylesheet type=text/css><script src=https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js></script>
<link rel=stylesheet href=http://shihchinw.github.io/css/prettyprint.css><link rel=stylesheet href=http://shihchinw.github.io/css/lightbox.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body)})</script><link rel=stylesheet type=text/css href=http://shihchinw.github.io/css/foundation.css><link rel=stylesheet type=text/css href=http://shihchinw.github.io/css/twentytwenty.css><link rel=stylesheet type=text/css href=http://shihchinw.github.io/css/header-anchor.css><link rel="shortcut icon" type=image/png href=http://shihchinw.github.io/favicon.png><style>.katex{font-size:1.1em!important}.intro-header .overlay{background:rgba(0,0,0,.47);z-index:1;width:100%;height:100%;top:0}p+ul{margin-top:-24px}p+ol{margin-top:-24px}h1+p,h2+p,h3+p{margin-top:15px}.summary-content{text-align:justify;margin:5px 0}a.read-more-link{color:#f44336;font-weight:bolder;margin-left:5px}code>div>.table{margin-bottom:0;padding:0}code>div>.table>tbody>tr>td{border-top:none;padding:0}.container .img-responsive{padding:5px;margin:auto;-moz-box-shadow:0 0 5px rgba(0,0,0,.15);-webkit-box-shadow:0 0 5px rgba(0,0,0,.15);box-shadow:0 0 5px rgba(0,0,0,.15);-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;margin-top:10px;margin-bottom:10px}.twentytwenty-container .img-responsive{padding:0;margin:0 auto;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;border-radius:0}.figure .img-responsive{padding:0;margin:auto;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;border-radius:0;margin-top:0;margin-bottom:5px}.figure{padding:5px;margin:auto;-moz-box-shadow:0 0 10px rgba(0,0,0,.2);-webkit-box-shadow:0 0 10px rgba(0,0,0,.2);box-shadow:0 0 10px rgba(0,0,0,.2);-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;margin-top:15px;margin-bottom:15px;display:table}figure figcaption{text-align:center;font-size:14px;color:gray}.container li a{text-decoration:underline}.container a:hover,a:focus{background:#a6dcf3;text-decoration:none}samp{display:block;background-color:#003700;font-size:.8em;text-align:left;color:#0f0;padding:5px;white-space:pre-wrap;border-radius:5px;margin:10px 0}samp.error{color:red}blockquote p:first-child,blockquote ul:first-child,blockquote ol:first-child{margin-top:0}.container blockquote{background:#fff1e5;padding:8px;margin-top:20px;margin-bottom:20px;text-align:justify;line-height:1.5;border:dashed;border-color:#e4c9c4}.container blockquote.feedback{white-space:pre-wrap}blockquote time{font-size:80%}blockquote{color:#806565}blockquote a{color:#337ab7}span.blue{border-bottom:1px solid #a6dcf3;box-shadow:inset 0 -6px #a6dcf3}span.orange{border-bottom:1px solid #ffd18c;box-shadow:inset 0 -6px #ffd699}span.red{color:#dc1111}span.green{border-bottom:1px solid #cdf9bb;box-shadow:inset 0 -6px #cdf9bb}.tag-box{list-style:none;margin:0;padding:4px 0;overflow:hidden}.tag-box.inline li{float:left}.tag-box li{padding:4px 6px;margin:2px;background-color:#e6e6e6;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}.tag-box li a{text-decoration:none}</style></head><body onload=PR.prettyPrint()><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=http://shihchinw.github.io>Shih-Chin</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav navbar-right"><li><a href=http://shihchinw.github.io/>home</a></li><li><a href=http://shihchinw.github.io/page/computer-graphics.html>Computer Graphics</a></li><li><a href=http://shihchinw.github.io/page/global-illumination.html>Global Illumination</a></li><li><a href=http://shihchinw.github.io/page/arnold.html>Arnold</a></li><li><a href=http://shihchinw.github.io/page/maya.html>Maya</a></li><li><a href=http://shihchinw.github.io/post.html>Posts</a></li><li><a href=http://shihchinw.github.io/about.html>About</a></li></ul></div></div></nav><header class=intro-header><div class=overlay><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>Building PySide for Maya 2012 on Windows</h1><h2 class=subheading></h2><span class=meta>Posted by Shih-Chin on Sun, May 27, 2012</span></div></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><p>One of my friend received some tools developed in PySide for Maya recently. He tried to copy the latest pre-built binaries of PySide into Maya&rsquo;s site-packages but got an import error. Therefore, we have to build the PySide for Maya from the ground up and this post is about the entire building process we&rsquo;ve been through. Hope this note might be helpful for people who want to use PySide in Maya. :)</p><p>BTW, the PySide for Maya 2012 built by vc9 can be downloaded <a href="https://docs.google.com/open?id=0BwFItFJF_4j3Wm1kMDVXcWIxbW8">here</a>, enjoy it!</p><h1 id=prerequisites>Prerequisites</h1><ul><li><a href=http://git-scm.com/download/win>git</a></li><li><a href=http://www.cmake.org/cmake/resources/software.html>cmake</a></li><li><a href=http://qt-project.org/wiki/jom>jom</a></li><li>visual c++</li></ul><h1 id=build-autodesk-modified-qt>Build autodesk modified Qt</h1><ol><li>download <a href=http://images.autodesk.com/adsk/files/qt-4.7.1-modified_for_maya_2012_service_pack_2.zip>QT4.7.1 modified for Maya 2012 Service Pack 2</a></li><li>extract files into C:\Qt\qt-adsk-4.7.1</li><li>cd C:\qt\qt-adsk-4.7.1</li><li>configure -platform win32-msvc2008 -release -no-qt3support</li><li>jom -j N (<em>N=how many cores do you want to use for compiling</em>)</li><li>set environment variable <strong>QTDIR=C:\qt-adsk-4.7.1</strong></li><li>append <strong>%QTDIR%\bin</strong> to your PATH environment variable</li></ol><p>OK, let&rsquo;s go for the packages of PySide. Assume we have following directory layout:</p><ul><li>D:\pyside_for_maya<ul><li>src\</li><li>deploy\</li></ul></li></ul><h1 id=build-shiboken>Build Shiboken</h1><ol><li>cd D:\pyside_for_maya\src</li><li>git clone git://gitorious.org/pyside/shiboken.git</li><li>cd shiboken</li><li>apply the <a href=https://github.com/PySide/Shiboken/issues/65>patch</a> [optional]</li><li>mkdir build</li><li>cd build</li><li>create a text file named <code>init_cache.txt</code> for cmake pre-load cache:<pre class="prettyprint lang=Cmake">
</li>
</ol>
<p>SET(CMAKE_BUILD_TYPE &ldquo;Release&rdquo; CACHE STRING &ldquo;&rdquo;);
SET(CMAKE_INSTALL_PREFIX &ldquo;d:/pyside_for_maya/deploy/shiboken&rdquo; CACHE PATH &ldquo;&rdquo;);
SET(BUILD_TESTS OFF CACHE BOOL &ldquo;&rdquo;); SET(MAYA_ROOT &ldquo;path-to-maya&rdquo; CACHE PATH &ldquo;&rdquo;);
SET(PYTHON_EXECUTABLE &ldquo;${MAYA_ROOT}/bin/mayapy.exe&rdquo; CACHE FILEPATH &ldquo;&rdquo;);
SET(PYTHON_INCLUDE_DIR &ldquo;${MAYA_ROOT}/include/python2.6&rdquo; CACHE PATH &ldquo;&rdquo;);
SET(PYTHON_LIBRARY &ldquo;${MAYA_ROOT}/lib/python26.lib&rdquo; CACHE FILEPATH &ldquo;&rdquo;);</pre></p><ol><li>cmake -G &ldquo;NMake Makefiles JOM&rdquo; -C &ldquo;init_cache.txt&rdquo; ..</li><li>jom -j N
ps. if you have the following error:
<samp class=error>[ 98%] Running generator for &lsquo;shiboken&rsquo;&mldr;
jom: D:\pyside_for_maya\src\shiboken\build\shibokenmodule\CMakeFiles\shibokenmod ule.dir\build.make [shibokenmodule\shiboken\shiboken_module_wrapper.cpp] Error 2
jom: D:\pyside_for_maya\src\shiboken\build\CMakeFiles\Makefile2 [shibokenmodule\CMakeFiles\shibokenmodule.dir\all] Error 2
jom: D:\pyside_for_maya\src\shiboken\build\Makefile [all] Error 2</samp> please copy QtCore4.dll from C:\Qt\qt-adsk-4.7.1\bin to
D:\pyside_for_maya\src\shiboken\build\generator and execute jom again</li><li>jom install</li></ol><h1 id=build-pyside>Build PySide</h1><ol><li>copy all dlls from C:\Qt\qt-adsk-4.7.1\bin to D:\pyside_for_maya\deploy\shiboken\bin [optional]</li><li>cd d:\pyside_for_maya\src</li><li>git clone git://gitorious.org/pyside/pyside.git</li><li>cd pyside</li><li>mkdir build</li><li>create <code>init_cache.txt</code>:<pre class="prettyprint lang=CMake">
</li>
</ol>
<p>SET(CMAKE_BUILD_TYPE Release CACHE STRING &ldquo;&rdquo;)
SET(CMAKE_INSTALL_PREFIX D:/pyside_for_maya/deploy/pyside CACHE PATH &ldquo;&rdquo;)
SET(BUILD_TESTS OFF CACHE BOOL &ldquo;&rdquo;)
SET(Shiboken_DIR D:/pyside_for_maya/deploy/shiboken/lib/cmake/Shiboken-1.1.2 CACHE PATH &ldquo;&rdquo;)</pre>7. make -G &ldquo;NMake Makefiles JOM&rdquo; -C &ldquo;init_cache.txt&rdquo; ..
8. jom -j N
9. jom install</p><p>Troubleshooting for compile error in step 8:
<samp class=error>[ 47%] Building CXX object PySide/QtGui/CMakeFiles/QtGui.dir/PySide/QtGui/qmessagebox_wrapper.cpp.obj D:\pyside_for_maya\src\pyside\build\PySide\QtGui\PySide\QtGui\qmenu_wrapper.cpp(3720) : error C2589: &lsquo;constant&rsquo; : illegal token on right side of &lsquo;::&rsquo;
D:\pyside_for_maya\src\pyside\build\PySide\QtGui\PySide\QtGui\qmenu_wrapper.cpp(3720) : error C2059: syntax error : &lsquo;::&rsquo;
jom: D:\pyside_for_maya\src\pyside\build\PySide\QtGui\CMakeFiles\QtGui.dir\build.make [PySide\QtGui\CMakeFiles\QtGui.dir\PySide\QtGui\qmenu_wrapper.cpp.obj] Error 2 qmessagebox_wrapper.cpp
jom: D:\pyside_for_maya\src\pyside\build\CMakeFiles\Makefile2 [PySide\QtGui\CMakeFiles\QtGui.dir\all] Error 2
jom: D:\pyside_for_maya\src\pyside\build\Makefile [all] Error 2
</samp>just fix the <code>line 3720</code> in
D:\pyside_for_maya\src\pyside\build\PySide\QtGui\PySide\QtGui\qmenu_wrapper.cpp to <span style=background-color:#ff0>::QPoint* cppArg0 = <del>QPoint::</del>NULL;</span></p><h1 id=deploy-pyside-packages>Deploy PySide packages</h1><p>Yeah, we are almost done! The last thing to do is to copy files from our deploy folder to path-to-maya\Python\lib\site-packages:</p><ol><li>shiboken\lib\site-packages\shiboken.pyd</li><li>pyside\lib\site-packages\PySide</li></ol><p>Besides, we also need to copy two dlls to path-to-maya\Python\lib\site\packages\<strong>PySide</strong></p><ol><li>pyside\bin\pyside-python2.6.dll</li><li>shiboken\bin\shiboken-python2.6.dll</li></ol><h1 id=simple-hello-world>Simple &ldquo;Hello World!&rdquo;</h1><ol><li>extract <a href="https://docs.google.com/open?id=0BwFItFJF_4j3aFdidG9kRHdYM2c">hello_pyside_for_maya.rar</a> to D:\</li><li>execute the following commands in Maya&rsquo;s script editor<pre class=prettyprint>
 import sys
 sys.path.append(r'D:\hello_pyside_for_maya')

 import mainwin as mw
 frame = mw.MainWindow()
 frame.show()</pre></li><li>If it executes successfully, you would see this simple window:
<img src=http://shihchinw.github.io/images/maya/hello_pyside_for_maya.PNG width=60%></li></ol><p>Congrats and enjoy the PySide in Maya. ;)</p><hr><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//shihchinw.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></article><hr><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:shihchin.weng@gmail.com><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/shihchinw><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/shihchinw><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright © Shih-Chin</p></div></div></div></footer><script src=http://shihchinw.github.io/js/jquery.min.js></script>
<script src=http://shihchinw.github.io/js/bootstrap.min.js></script>
<script src=http://shihchinw.github.io/js/clean-blog.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-336629647"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-336629647",{anonymize_ip:!1})}</script><script src=http://shihchinw.github.io/js/lightbox.js></script>
<script src=http://shihchinw.github.io/js/jquery.event.move.js></script>
<script src=http://shihchinw.github.io/js/jquery.twentytwenty.js></script>
<script>$(window).load(function(){$(".twentytwenty-container[data-orientation!='vertical']").twentytwenty({default_offset_pct:.7}),$(".twentytwenty-container[data-orientation='vertical']").twentytwenty({default_offset_pct:.3,orientation:"vertical"})}),$(function(){return $("h1, h2, h3, h4, h5, h6").each(function(e,t){var n=$(t),s=n.attr("id"),o='<i class="fa fa-link"></i>';if(s)return n.append($("<a />").addClass("header-link").attr("href","#"+s).html(o))})})</script></body></html>