<!DOCTYPE html>
<html lang="en-us">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Quick Start Guide for PySide in Maya -- Shih-Chin</title>

    

    
    <link href="http://shihchin.com/css/bootstrap.css" rel="stylesheet">

    
    <link href="http://shihchin.com/css/clean-blog.css" rel="stylesheet">

    
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:400,400italic|Open+Sans:400italic,600italic,400,600|Coda:800)' media='screen' rel='stylesheet' type='text/css'/>

    
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" href="http://shihchin.com/css/prettyprint.css">
    

    <link rel="stylesheet" href="http://shihchin.com/css/lightbox.css">

    
    
    

    
    <script type='text/x-mathjax-config'>
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ['\\(','\\)'] ]
            },
            processEscapes: true,
            processEnvironments: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            TeX: {
                equationNumbers: { autoNumber: "AMS" },
                extensions: ["AMSmath.js", "AMSsymbols.js"]
            },
            "HTML-CSS": {
                preferredFont: "TEX",
                scale : 85
            }
        });
    </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>

    <link rel="stylesheet" type="text/css" href="http://shihchin.com/css/foundation.css">
    <link rel="stylesheet" type="text/css" href="http://shihchin.com/css/twentytwenty.css">
    <link rel="stylesheet" type="text/css" href="http://shihchin.com/css/header-anchor.css">
    <link rel="shortcut icon" type="image/png" href="http://shihchin.com/favicon.png">

    <style>
    .intro-header .overlay {
        background: rgba(0, 0, 0, 0.47);
        z-index: 1;
        width: 100%;
        height: 100%;
        top: 0;
    }

    p + ul { margin-top: -24px; }
    p + ol { margin-top: -24px; }
    h1 + p, h2 + p, h3 + p { margin-top: 15px; }

    .summary-content {
        text-align: justify;
        margin: 5px 0px 5px 0px;
    }

    a.read-more-link {
        text-decoration: none;
        color: #FF9800;
        font-weight: bolder;
        margin-left: 5px;
    }

    code > div > .table {
        margin-bottom: 0px;
        padding: 0px;
    }

    code > div > .table > tbody > tr > td {
        border-top: none;
        padding: 0px;
    }

    .container .img-responsive {
        padding: 5px;
        margin: auto;
        -moz-box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        -webkit-box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius: 5px;
        margin-top: 10px;
        margin-bottom: 10px;
    }

    .twentytwenty-container .img-responsive {
        padding: 0px;
        margin: 0px auto;
        -moz-box-shadow: none;
        -webkit-box-shadow: none;
        box-shadow: none;
        border-radius: 0px;
    }

    .figure .img-responsive {
        padding: 0px;
        margin: auto;
        -moz-box-shadow: none;
        -webkit-box-shadow: none;
        box-shadow: none;
        border-radius: 0px;
        margin-top: 0px;
        margin-bottom: 5px;
    }

    .figure {
        padding: 5px;
        margin: auto;
        -moz-box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        -webkit-box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius: 5px;
        margin-top: 15px;
        margin-bottom: 15px;
        display: table;
    }

    figure figcaption {
         
        text-align: center;
        font-size: 14px;
         
        color: #808080;
    }

    .container li a {
        text-decoration: underline;
    }

    .container a:hover, a:focus {
         
        background: #A6DCF3;
        text-decoration: none;
    }

    samp {
        display: block;
        background-color: rgba(0, 55, 0, 1);
        font-size: 0.8em;
        text-align: left;
        color: rgba(0, 255, 0, 1);
        padding: 5px;
        white-space: pre-wrap;
        border-radius: 5px;
        margin: 10px 0px;
    }

    samp.error {
        color: red;
    }

    blockquote p:first-child, blockquote ul:first-child, blockquote ol:first-child {
        margin-top: 0;
    }

    .container blockquote {
         
        background: #FFF1E5;
        padding: 8px;
        margin-top: 20px;
        margin-bottom: 20px;
         
        text-align: justify;
        line-height: 1.5;
        border: dashed;
        border-color: rgb(228, 201, 196);
    }

    .container blockquote.feedback {
        white-space: pre-wrap;
    }

    blockquote time {
        font-size: 80%;
    }

    blockquote {
        color: #806565;
    }

    blockquote a {
        color: #337ab7;
    }

    span.blue {
        border-bottom: 1px solid #a6dcf3;
        box-shadow: inset 0 -6px 0 #a6dcf3;
    }
    span.orange {
        border-bottom: 1px solid #ffd8ae;
        box-shadow: inset 0 -6px 0 #ffd8ae;
    }
    span.red { color: #dc1111; }
    span.green {
        border-bottom: 1px solid #cdf9bb;
        box-shadow: inset 0 -6px 0 #cdf9bb;
    }

    .tag-box {
        list-style: none;
        margin: 0;
        padding: 4px 0;
        overflow: hidden;
    }
    .tag-box.inline li {
        float: left;
    }
    .tag-box li {
        padding: 4px 6px;
        margin: 2px;
        background-color: #e6e6e6;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        border-radius: 4px;
    }
    .tag-box li a {
        text-decoration: none;
    }
    </style>

</head>

<body onload="PR.prettyPrint()">

    
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://shihchin.com">Shih-Chin</a>
            </div>
            
<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav navbar-right">
        
        <li>
            <a href="http://shihchin.com/">home</a>
        </li>
        
        <li>
            <a href="http://shihchin.com/page/computer-graphics.html">Computer Graphics</a>
        </li>
        
        <li>
            <a href="http://shihchin.com/page/global-illumination.html">Global Illumination</a>
        </li>
        
        <li>
            <a href="http://shihchin.com/page/arnold.html">Arnold</a>
        </li>
        
        <li>
            <a href="http://shihchin.com/page/maya.html">Maya</a>
        </li>
        
        <li>
            <a href="http://shihchin.com/post.html">Posts</a>
        </li>
        
        <li>
            <a href="http://shihchin.com/page/about.html">About</a>
        </li>
        
      </ul>
</div>


        </div>
        
    </nav>


    
    
    <header class="intro-header">
    
      <div class="overlay">
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <div class="post-heading">
                <h1>Quick Start Guide for PySide in Maya</h1>
                <h2 class="subheading"></h2>
                <span class="meta">
                 
Posted by Shih-Chin on Sat, May 2, 2015


               </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                  

<p>The goal of tool-making is to make users do certain works more efficiently. A functional tool with poor designed interface would not be fully utilized by users, because users aren&rsquo;t willing to use that tool if the interaction makes them feel frustrated.</p>

<h1 id="developing-is-a-iterative-process">Developing is a Iterative Process</h1>

<p>Although there are a few <a href="http://bokardo.com/principles-of-user-interface-design/">principles</a> about user interface design, but it doesn&rsquo;t mean that we can simply apply those principles and get our jobs done. In day-to-day situations, tool-development is a iterative process. As a developer, we&rsquo;d better continuously communicate with our target users, and do some modifications according to the feedback, and repeat those processes back and forth until users&rsquo;  workflows are truly improved. (In my personal experience, the much users like our tool, the more feedback they will give us.)</p>

<h1 id="functionalities-and-user-interface">Functionalities and User-Interface</h1>

<p>In early development stage, we might change the interface design frequently. In order to make our life easier, we&rsquo;d better avoid putting all these codes into a single Python script. We can decompose the source codes to two primary parts: one is the underlying functionalities, the other is for layout design. This loose-coupling idea make us possible to redesign the layout without amending any code for underlying functionalities. Besides, the code is easier to maintain, because we can focus on each part respectively without worrying about other interferences.</p>

<blockquote>
<p>Furthermore, when we develop a tool with more complicated functionalities and interactions, it would be better to adopt the Model-View-Controller pattern. It separates the logic into data accessing model, view presentation and the interaction between them.</p>

<p>More Information about MVC
* <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">Model-View-Controller</a> @wiki
* <a href="http://doc.qt.io/qt-4.8/model-view-programming.html">Model-View programming</a></p>
</blockquote>

<h1 id="workflow">Workflow</h1>

<p><img src="http://shihchin.com/images/pyside/pyside_maya_workflow.png" alt="PySide Workflow" /><br></p>

<ol>
<li>Design the custom UI layout with QtDesigner</li>
<li>Compile ui file to py script</li>
<li>Combine the design and functionality</li>
<li>Invoke the UI from Script Editor</li>
<li>Update the Layout via reload()
The example files can be downloaded <a href="https://drive.google.com/file/d/0BzMAAU0MqqtQVVBGU2ZyRU1EbFk/view?usp=sharing">here</a>.</li>
</ol>

<h2 id="design-the-custom-ui-layout-with-qtdesigner">Design the custom UI layout with QtDesigner</h2>

<ul>
<li>The designer is shipped with Maya, we can find it in <strong>$(MAYA_ROOT)\bin\designer.exe</strong></li>
<li>We can simply design the layout via the drag-and-drop interface. (Learn <a href="http://doc.qt.io/qt-4.8/designer-manual.html">more</a> about QtDesigner)</li>
</ul>

<p><img src="http://shihchin.com/images/pyside/qtRobotMayaDesigner.png" alt="QtDesigner" /> <br></p>

<ul>
<li>We could also setup the signal/slot relationship in designer.

<ul>
<li>Here we make the rightDial synced with leftDial</li>
</ul></li>
</ul>

<p><img src="http://shihchin.com/images/pyside/signal-slot-editor.png" alt="Singal-Slot Editor" /></p>

<h2 id="compile-ui-file-to-py-script">Compile ui file to py script</h2>

<pre class="prettyprint">
$(MAYA_BIN)\mayapy $(MAYA_BIN)\pyside-uic design.ui -o uiDesign.py
</pre>

<p><img src="http://shihchin.com/images/pyside/pyside-uic-helps.png" alt="pyside-uic" /></p>

<h2 id="combine-the-design-and-functionality">Combine the design and functionality</h2>

<p>Create a new file mainwin.py and</p>

<ul>
<li>Import <code>uiDesign.py</code> which is compiled from <code>design.ui</code> previously. <em>line#7</em></li>
<li>Inherit the mixin class (e.g. Ui_RobotWindow) and invoke <code>self.setupUi()</code> to create the layout. <em>line#13-16</em></li>
<li>Connect signal to proper slots which are responsible for each specific task respectively. <em>line#19</em></li>
</ul>

<pre class="prettyprint linenums lang-python">
#!/usr/bin/env python
import sys

from PySide.QtCore import *
from PySide.QtGui import *
from shiboken import wrapInstance
import uiDesign
reload(uiDesign)

import maya.cmds as cmds
import maya.OpenMayaUI as omui

class RobotWindow(QMainWindow, uiDesign.Ui_RobotWindow):
    def __init__(self, parent=None):
        super(RobotWindow, self).__init__(parent)
        self.setupUi(self)

        # Setup signal/slot connections...
        self.horizontalSlider.valueChanged.connect(self.setCurrentTime)

    def setCurrentTime(self, value):
        minTime = cmds.playbackOptions(q=True, min=True)
        maxTime = cmds.playbackOptions(q=True, max=True)
        time = (maxTime - minTime) * value / 100
        cmds.currentTime(time, e=True)

def initUi():
    mayaMainWindowPtr = omui.MQtUtil.mainWindow()
    mayaMainWindow = wrapInstance(long(mayaMainWindowPtr), QWidget)
    # Create a instance of our RobotWindow and set its parent
    # to the main window of Maya.
    myWin = RobotWindow(mayaMainWindow)
    myWin.show()
</pre>

<p>Make sure to parent our widget under an existing Maya widget (such as Maya&rsquo;s main window). Otherwise, if the widget is un-parented, it may be destroyed by the Python interpreter&rsquo;s garbage collector when a reference to it is not maintained.</p>

<h2 id="invoke-the-ui-from-script-editor">Invoke the UI from Script Editor</h2>

<pre class="prettyprint linenums lang-python">
import sys
sys.path.append(r'DIR_PATH_TO_THE_SCRIPTS')
import mainwin as MyMainWin
MyMainWin.initUi()
</pre>

<p>If everything works fine, we should see a window with robot face with following features:</p>

<p><img src="http://shihchin.com/images/pyside/qtRobotMaya.png" alt="QtRobot" /></p>

<ul>
<li>Left dial (eye) will trigger the movement of right dial</li>
<li>The bottom slider (mouth) controls the current time in the range of Maya&rsquo;s playback slider</li>
</ul>

<h2 id="update-the-layout-via-reload">Update the Layout via reload()</h2>

<p>When we want to update the latest layout from design.ui, the first thing is to compile it to uiDesign.py via pyside-uic. Then, we&rsquo;ve to reload the module uiDesign <strong>AND</strong> mainwin to make sure all definitions are up-to-date. Why do we need to reload both modules? Let&rsquo;s check the <a href="https://docs.python.org/2.7/library/functions.html?highlight=reload#reload">reload()</a> in docs:</p>

<blockquote>
<p>When reload(module) is executed, other references to the old objects (such as names external to the module) are <strong>not</strong> rebound to refer to the new objects and must be updated in each namespace where they occur if that is desired.</p>

<p>If a module instantiates instances of a class, reloading the module that defines the class does <strong>not</strong> affect the method definitions of the instances — they continue to use the old class definition. The same is true for derived classes.</p>
</blockquote>

<p>In other words, if we only reload mainwin, it would <strong>not</strong> update the uiDesign <span class="orange">because the module uiDesign is imported within the mainwin.</span> In addition, if we only reload uiDesign, <span class="orange">the instance of RobotWindow is still using the <strong>old</strong> definition of uiDesign.</span> That&rsquo;s why we need to reload them both, however, in order to save manual steps for updating, I simply put <code>reload(uiDesign)</code> in <em>line#8</em>. Thus we could get the up-to-date result every time we reload the mainwin.</p>

<p>Few discussions about <strong>reload()</strong> @stackoverflow:</p>

<ul>
<li><a href="http://stackoverflow.com/questions/16675066/reloading-dependent-modules-in-python">reloading dependent modules in Python</a></li>
<li><a href="http://stackoverflow.com/questions/1827629/how-to-find-list-of-modules-which-depend-upon-a-specific-module-in-python/">how to find list of modules which depend upon a specific module in python</a></li>
<li><a href="http://stackoverflow.com/questions/1739924/python-reload-component-y-imported-with-from-x-import-y">reload component Y imported with &lsquo;from X import Y&rsquo;?</a></li>
</ul>

<h1 id="references">References</h1>

<ul>
<li><a href="http://wiki.qt.io/Pyside">PySide</a></li>
<li><a href="http://www.qtrac.eu/pyqtbook.html">Rapid programming from PyQt</a></li>
<li><a href="http://qt-project.org/doc/qt-4.8/designer-manual.html">Qt Designer Manual</a></li>
<li>Maya doc

<ul>
<li><a href="http://help.autodesk.com/view/MAYAUL/2015/ENU/?guid=__files_GUID_CEC1D76B_7568_4DCA_B80B_1DE49362492C_htm">Using LoadUI command</a></li>
<li><a href="http://help.autodesk.com/view/MAYAUL/2015/ENU/?guid=__files_GUID_3F96AF53_A47E_4351_A86A_396E7BFD6665_htm">Working with PySide in Maya</a></li>
</ul></li>
</ul>

                  
    <hr>
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'shihchinw';
    var disqus_identifier = 'http:\/\/shihchin.com\/2015\/05\/quick-start-guide-for-pyside-in-maya.html';
    var disqus_title = 'Quick Start Guide for PySide in Maya';
    var disqus_url = 'http:\/\/shihchin.com\/2015\/05\/quick-start-guide-for-pyside-in-maya.html';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


                </div>
            </div>
        </div>
    </article>

    <hr>
    
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                  <ul class="list-inline text-center">
                    
                      <li>
                        <a href="mailto:shihchin.weng@gmail.com">
                          <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                          </span>
                        </a>
                      </li>
                    
                    
                    <li>
                      <a href="https://twitter.com/shihchinw">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="https://github.com/shihchinw">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                  </ul>
                  <p class="copyright text-muted">Copyright © Shih-Chin</p>
                </div>
            </div>
        </div>
    </footer>

    
    <script src="http://shihchin.com/js/jquery.min.js"></script>

    
    <script src="http://shihchin.com/js/bootstrap.min.js"></script>

    
    <script src="http://shihchin.com/js/clean-blog.js"></script>

    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-71352938-1', 'auto');
ga('send', 'pageview');
</script>


    <script src="http://shihchin.com/js/lightbox.js"></script>

    <script src="http://shihchin.com/js/jquery.event.move.js"></script>
    <script src="http://shihchin.com/js/jquery.twentytwenty.js"></script>
    

    <script>
        $(window).load(function(){
          $(".twentytwenty-container[data-orientation!='vertical']").twentytwenty({default_offset_pct: 0.7});
          $(".twentytwenty-container[data-orientation='vertical']").twentytwenty({default_offset_pct: 0.3, orientation: 'vertical'});
        });

        
        $(function() {
          return $("h1, h2, h3, h4, h5, h6").each(function(i, el) {
            var $el, icon, id;
            $el = $(el);
            id = $el.attr('id');
            icon = '<i class="fa fa-link"></i>';
            if (id) {
              return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
            }
          });
        });
    </script>
</body>

</html>

