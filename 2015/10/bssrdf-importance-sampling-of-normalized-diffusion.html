<!DOCTYPE html>
<html lang="en-us">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>BSSRDF Importance Sampling of Normalized Diffusion</title>

    

    
    <link href="http://shihchinw.github.io/css/bootstrap.css" rel="stylesheet">

    
    <link href="http://shihchinw.github.io/css/clean-blog.css" rel="stylesheet">

    
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:400,400italic|Open+Sans:400italic,600italic,400,600|Coda:800)' media='screen' rel='stylesheet' type='text/css'/>

    
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <link rel="stylesheet" href="http://shihchinw.github.io/css/prettyprint.css">
    

    <link rel="stylesheet" href="http://shihchinw.github.io/css/lightbox.css">

    
    
    

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css" integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js" integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/contrib/auto-render.min.js" integrity="sha384-yACMu8JWxKzSp/C1YV86pzGiQ/l1YUfE8oPuahJQxzehAjEt2GiQuy/BIvl9KyeF" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body);
        });
    </script>

    <link rel="stylesheet" type="text/css" href="http://shihchinw.github.io/css/foundation.css">
    <link rel="stylesheet" type="text/css" href="http://shihchinw.github.io/css/twentytwenty.css">
    <link rel="stylesheet" type="text/css" href="http://shihchinw.github.io/css/header-anchor.css">
    <link rel="shortcut icon" type="image/png" href="http://shihchinw.github.io/favicon.png">

    <style>
    .katex { font-size: 1.1em !important; }

    .intro-header .overlay {
        background: rgba(0, 0, 0, 0.47);
        z-index: 1;
        width: 100%;
        height: 100%;
        top: 0;
    }

    p + ul { margin-top: -24px; }
    p + ol { margin-top: -24px; }
    h1 + p, h2 + p, h3 + p { margin-top: 15px; }

    .summary-content {
        text-align: justify;
        margin: 5px 0px 5px 0px;
    }

    a.read-more-link {
        color: #f44336;
        font-weight: bolder;
        margin-left: 5px;
    }

    code > div > .table {
        margin-bottom: 0px;
        padding: 0px;
    }

    code > div > .table > tbody > tr > td {
        border-top: none;
        padding: 0px;
    }

    .container .img-responsive {
        padding: 5px;
        margin: auto;
        -moz-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
        -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
        box-shadow: 0 0 5px rgba(0, 0, 0, .15);
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius: 5px;
        margin-top: 10px;
        margin-bottom: 10px;
    }

    .twentytwenty-container .img-responsive {
        padding: 0px;
        margin: 0px auto;
        -moz-box-shadow: none;
        -webkit-box-shadow: none;
        box-shadow: none;
        border-radius: 0px;
    }

    .figure .img-responsive {
        padding: 0px;
        margin: auto;
        -moz-box-shadow: none;
        -webkit-box-shadow: none;
        box-shadow: none;
        border-radius: 0px;
        margin-top: 0px;
        margin-bottom: 5px;
    }

    .figure {
        padding: 5px;
        margin: auto;
        -moz-box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        -webkit-box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        box-shadow: 0 0 10px rgba(0, 0, 0, .2);
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius: 5px;
        margin-top: 15px;
        margin-bottom: 15px;
        display: table;
    }

    figure figcaption {
         
        text-align: center;
        font-size: 14px;
         
        color: #808080;
    }

    .container li a {
        text-decoration: underline;
    }

    .container a:hover, a:focus {
         
        background: #A6DCF3;
        text-decoration: none;
    }

    samp {
        display: block;
        background-color: rgba(0, 55, 0, 1);
        font-size: 0.8em;
        text-align: left;
        color: rgba(0, 255, 0, 1);
        padding: 5px;
        white-space: pre-wrap;
        border-radius: 5px;
        margin: 10px 0px;
    }

    samp.error {
        color: red;
    }

    blockquote p:first-child, blockquote ul:first-child, blockquote ol:first-child {
        margin-top: 0;
    }

    .container blockquote {
         
        background: #FFF1E5;
        padding: 8px;
        margin-top: 20px;
        margin-bottom: 20px;
         
        text-align: justify;
        line-height: 1.5;
        border: dashed;
        border-color: rgb(228, 201, 196);
    }

    .container blockquote.feedback {
        white-space: pre-wrap;
    }

    blockquote time {
        font-size: 80%;
    }

    blockquote {
        color: #806565;
    }

    blockquote a {
        color: #337ab7;
    }

    span.blue {
        border-bottom: 1px solid #a6dcf3;
        box-shadow: inset 0 -6px 0 #a6dcf3;
    }
    span.orange {
        border-bottom: 1px solid #ffc672;
        box-shadow: inset 0 -6px 0 #ffc672;
    }
    span.red { color: #dc1111; }
    span.green {
        border-bottom: 1px solid #cdf9bb;
        box-shadow: inset 0 -6px 0 #cdf9bb;
    }

    .tag-box {
        list-style: none;
        margin: 0;
        padding: 4px 0;
        overflow: hidden;
    }
    .tag-box.inline li {
        float: left;
    }
    .tag-box li {
        padding: 4px 6px;
        margin: 2px;
        background-color: #e6e6e6;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        border-radius: 4px;
    }
    .tag-box li a {
        text-decoration: none;
    }
    </style>

</head>

<body onload="PR.prettyPrint()">

    
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://shihchinw.github.io">Shih-Chin</a>
            </div>
            
<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav navbar-right">
        
        <li>
            <a href="http://shihchinw.github.io/">home</a>
        </li>
        
        <li>
            <a href="http://shihchinw.github.io/page/computer-graphics.html">Computer Graphics</a>
        </li>
        
        <li>
            <a href="http://shihchinw.github.io/page/global-illumination.html">Global Illumination</a>
        </li>
        
        <li>
            <a href="http://shihchinw.github.io/page/arnold.html">Arnold</a>
        </li>
        
        <li>
            <a href="http://shihchinw.github.io/page/maya.html">Maya</a>
        </li>
        
        <li>
            <a href="http://shihchinw.github.io/post.html">Posts</a>
        </li>
        
        <li>
            <a href="http://shihchinw.github.io/about/">About</a>
        </li>
        
      </ul>
</div>


        </div>
        
    </nav>


    
    
    <header class="intro-header" style="background-image: url('http://shihchinw.github.io/images/header/posts/2015-10-27-bssrdf-importance-sampling-of-normalized-diffusion.jpg')">
    
      <div class="overlay">
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <div class="post-heading">
                <h1>BSSRDF Importance Sampling of Normalized Diffusion</h1>
                <h2 class="subheading"></h2>
                <span class="meta">
                 
Posted by Shih-Chin on Tue, Oct 27, 2015


               </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                  

<p>Highly scattering materials like milk or skin can&rsquo;t be precisely modeled by BRDF only, because light would scatter multiple times before exiting the material at different locations. Bidirectional surface scattering distribution function (BSSRDF) is used to describe radiance transfer across the surface boundary with diffusion profile for multiple scattering events.</p>

<p>To solve subsurface light transport efficiently, there are several approaches to model and evaluate the diffusion profile. Recently, Burley [<a href="#ref.5">5</a>] has proposed an artist-friendly diffusion profile with <em>only two</em> exponential functions and the most attracting thing is that it&rsquo;s not only intuitive for artists to use but also faster to evaluate. It&rsquo;s a great exercise to try it out for fun in Arnold.</p>

<h1 id="bssrdf-diffusion-profile">BSSRDF &amp; Diffusion Profile</h1>

<p><img src="http://shihchinw.github.io/images/rlShaders/bssrdf_scatter.png" style="box-shadow: none;"></p>

<p>BSSRDF is a function relates outgoing radiance to the incident flux at different points:</p>

<p>$$S(x_i,\vec{\omega_i};x_o,\vec{\omega_o})=\frac{dL_0(x_o,\vec{\omega_o})}{d\phi_i(x_i,\vec{\omega_i})}$$</p>

<p>For efficiency, \(S\) can be decomposed into single-scattering and multiple-scattering terms. The multiple scatter term \(S_d\) is too complex to solve directly, the common strategy is to use a <code>diffusion profile</code> to approximate the distribution of outgoing radiance. With the diffusion approximation to the <em>radiative transport equation</em> (RTE), \(S_d\) is represented by a product of two Fresnel refraction terms and a diffusion profile in BSSRDF:</p>

<p>$$S_d(x_i,\vec{\omega_i};x_o,\vec{\omega_o})=\frac{1}{\pi}F_t(\eta,\vec{\omega_i})R_d(\vert x_i-x_o\vert)F_t(\eta,\vec{\omega_o})$$</p>

<p>and the subsurface light transport is formulated as:</p>

<p>$$L_o(x_o,\vec{\omega_o}) = \int_A{ \int_\Omega{ S(x_i,\vec{\omega_i};x_o,\vec{\omega_o}) L_i(x_i,\vec{\omega_i}) (n\cdot\vec{\omega_i}) d\omega_i } dA(x_i) }$$</p>

<blockquote>
<p>There are many technical terms among the academic papers, such as fluence, mean free path, etc. I found the best introductory reading materials to understand the relevant details of sub-surface scattering approximation are:</p>

<ul>
<li><a href="https://graphics.stanford.edu/papers/bssrdf/">A Practical Model for Subsurface Light Transport</a>. Jensen et al. 2001.</li>
<li><a href="http://www.cs.jhu.edu/~misha/Fall11/Donner.Thesis.pdf">Towards Realistic Image Synthesis of Scattering Materials</a>. Donner. 2006.</li>
<li><a href="http://graphics.pixar.com/library/PhotonBeamDiffusion/index.html">Classical and Improved Diffusion Theory for Subsurface Scattering</a>. Ralf Habel et al. 2013.</li>
</ul>

<p>About the diffusion profiles, there are several profiles such as diploe, multipole, quantized diffusion and directional dipole. The presentation <a href="http://www.ci.i.u-tokyo.ac.jp/~hachisuka/dirpole_slides.pdf">slides</a> of directional profile [J. R. Frisvad et al. 2014] has great illustrations for the integration scheme of each diffusion profile.</p>
</blockquote>

<h1 id="bssrdf-importance-sampling-framework-in-arnold">BSSRDF Importance Sampling Framework in Arnold</h1>

<p>To solve the subsurface light transport, two primary approaches are used in graphics community. One is a multi-pass technique, which uses point cloud over the surface to store the diffuse irradiance at each point in pre-processing stage, then utilize that irradiance cache to solve the light transport equation in second phase.</p>

<p><img src="http://shihchinw.github.io/images/rlShaders/bssrdf_sampling.png" style="box-shadow: none;"></p>

<p>The other is to perform importance sampling of the diffusion profile directly. Without the needs of point cloud generation, this approach fits well in any path-tracer with probe tracing API. The state-of-the-art sampling method proposed by King et al. [<a href="#ref.4">4</a>] can be summarized to following steps:</p>

<ol>
<li>Sample a point on disk with PDF in proportion to the diffusion profile \(R(r)\).</li>
<li>Randomly select probe orientation with local basis U, V, N at \(x_o\).</li>
<li>Compute probe origin and direction from the selected orientation.</li>
<li>Trace probe rays to shade all hit points within a range of max radius.</li>
<li>Combine sample results with MIS (Multiple Importance Sampling):
$$w_i = \frac{R_d(|x_o-x_i|)}{\sum_j{c_j\ pdf_{disk}(r_j) |\vec{n_o}\cdot\vec{n_i}|}}\kern{2em}$$
where \(c_j\) is the sample weight of probe axis selection (N:0.5, U:0.25, V:0.25), and \(r_j\) is the projected radius on UV, NV, NU plane.</li>
</ol>

<p>Arnold SDK only provides APIs for Gaussian and cubic profile currently, for other profiles, we have to implement the sampling routine from scratch. The implementation details would be discussed in later section. Now, let&rsquo;s see how to sample the radius \(r\) from the normalized diffusion profile \(R(r)\).</p>

<h1 id="importance-sampling-of-normalized-diffusion">Importance Sampling of Normalized Diffusion</h1>

<p><em>Normalized diffusion</em> profile [<a href="#ref.5">5</a>][<a href="#ref.6">6</a>] is formulated by two exponential functions:</p>

<p>$$R(r)=\frac{e^{\frac{-r}{d}} + e^{\frac{-r}{3d}}}{8\pi dr}$$</p>

<p>and the beauty of this model is that with <span class="green"><strong>any positive value of \(d\) the integration over the disk is always one:</strong></span></p>

<p>$$\int_0^\infty{\int_0^{2\pi}{R(r)r\ d\phi}\ dr}=\int_0^\infty{R(r)2\pi r\ dr}=1$$</p>

<p>(The parameter \(d\) can be interpreted as the scattering distance for artistic control. For its relationship to other physical quantities like surface albedo and mean free path, please refer to [<a href="#ref.6">6</a>])</p>

<p>Although \(R(r)\) is surprising simple, but its CDF is not analytically invertible. Therefore, I try to randomly select one exponential and generate sample \(r\) from it, then use MIS to combine the sample weights. Besides, in order to make probe tracing faster and to reduce the variance (noise), it&rsquo;s better to restrict the integration domain within a user defined max radius \(R_{max}\).</p>

<h2 id="lobe-selection">Lobe selection</h2>

<p>There are two exponential functions and three distance values \(d\) for R, G, B. In other words, there are <span class="blue"><strong>six lobes</strong></span> to sample. Before sampling the radius \(r\) on disk, we need to select a lobe in two steps:</p>

<ol>
<li>Choose the value of \(d\) from R, G, B <span class="blue"><strong>uniformly</strong></span>.

<ul>
<li>Since every positive \(d\) would always get one for the integral of \(R(r)\).</li>
</ul></li>
<li>Given \(d\), use the ratio of integration within \(R_{max}\) to select the exponential function:</li>
</ol>

<div>
$$\begin{aligned}
w_1 &= 1 - e^{\frac{-R_{max}}{d}} \\
w_2 &= 3 (1 - e^{\frac{-R_{max}}{3d}})
\end{aligned}$$
</div>

<h2 id="sample-r-from-a-lobe">Sample \(r\) from a lobe</h2>

<p>Suppose the PDF of the first exponential is \(p_1(r)\propto \frac{e^{-r/d}}{8\pi dr}\), and it&rsquo;s normalized in range \([0, R_{max}]\)</p>

<div>$$\int{c\ \frac{e^{-r/d}}{8\pi dr} 2\pi r\ dr} = \int{\frac{c}{4d}e^{-r/d}\ dr} = \frac{-c}{4}(e^{\frac{-R_{max}}{d}-1}) = 1$$
$$c = \frac{4}{1-e^{\frac{-R_{max}}{d}}} \implies p_1(r)=\frac{e^{-r/d}}{2\pi dr}\frac{1}{1-e^{\frac{-R_{max}}{d}}}$$</div>

<p>Then the CDF of \(p_1(r)\) and its inverse function are:</p>

<div>$$\begin{aligned}
P_1(r) &= \int_0^r{p_1(r')2\pi r'\ dr'} \\
&= \int_0^r{\frac{e^{-r'/d}}{d} \frac{1}{1-e^{\frac{-R_{max}}{d}}} dr'} \\
&= \frac{-1}{1-e^{\frac{-R_{max}}{d}}}(e^{\frac{-r}{d}}-1)
\end{aligned}$$
$$r = \log(1-\xi(1-e^{\frac{-R_{max}}{d}})) \times -d$$</div>

<p>Likewise, we can get the following formulas for the second exponential:</p>

<div>$$p_2(r)=\frac{e^{\frac{-r}{3d}}}{2\pi dr}\frac{1}{3(1-e^{\frac{-R_{max}}{3d}})},\ r = \log(1-\xi(1-e^{\frac{-R_{max}}{3d}})) \times -3d$$</div>

<h1 id="implementation-details">Implementation Details</h1>

<h2 id="retrieve-correct-hit-states-from-aitraceprobe">Retrieve Correct Hit States from AiTraceProbe</h2>

<p><img src="http://shihchinw.github.io/images/rlShaders/ai_false_probe_trace.jpg"></p>

<p>During surface shading computation, the shading context of sg is AI_CONTEXT_SURFACE, and I found <code>AiTraceProbe</code> would <span class="red">always return false when the probe ray hits an identical triangle to the one stored in previous sg.</span> To resolve this issue, at first I try to switch its shading context to AI_CONTEXT_DISPLACEMENT before each <code>AiTraceProbe</code>, then I found we could simply change <code>sg-&gt;fi</code> (the id of hit primitive) to UI_MAX to make it work properly.</p>

<p>In addition, about direct lighting evaluation, it would crash at <code>AiLightsPrepare</code> if we pass the returned AtShaderGlobals from <code>AiTraceProbe</code> directly. Thus we have to copy related information like P, Nf, Ng from in-scatter point to original sg before evaluating the light loop.</p>

<h2 id="stackless-shading-for-multiple-probe-hits">Stackless Shading For Multiple Probe Hits</h2>

<p>To shade thin geometry correctly, we need to shade multiple hits along the probing direction. Although we could use shader message passing API to carry the shading samples along the ray, but <code>AiTrace</code> would <span class="red">increase the number of call stacks and slow down the rendering.</span> Therefore, I use <code>AiTraceProbe</code> to retrieve the hit information and integrate direct/indirect illumination at each hit point.</p>

<h2 id="reduce-incoming-radiance-from-opposite-faces">Reduce Incoming Radiance From Opposite Faces</h2>

<p>Sometimes the energy from opposite faces would make the result too bright and need further reduction. For the consideration of surface cavity, I currently use \(\cos{\theta/2}\) to fade out the incoming radiance. Where the \(\theta\) is determined differently for front-facing (\(x_{i1}\)) and back-facing (\(x_{i2}\)) cases:</p>

<p><img src="http://shihchinw.github.io/images/rlShaders/bssrdf_cavity_affects_diffusion.png" style="box-shadow: none;"></p>

<div>$$\theta = \begin{cases}
\arccos(\vec{n_o}\cdot\vec{n_i}) &\text{if } \vec{v}\cdot\vec{n_o} \ge 0 \\
\arccos(\vec{v}\cdot\vec{n_i}) & \text{otherwise}
\end{cases}, where\ \vec{v}\ is\ \frac{x_i-x_o}{\vert x_i-x_o\vert}$$</div>

<p>The source code could be found <a href="https://github.com/shihchinw/rlShaders/blob/master/src/rlSssND.cpp">here</a>.</p>

<h1 id="results">Results</h1>

<p><a href="http://shihchinw.github.io/images/rlShaders/rlSssNd_buddha.jpg" data-lightbox="results"><img src="http://shihchinw.github.io/images/rlShaders/rlSssNd_buddha.jpg"></a></p>

<figure class="figure">
<a href="http://shihchinw.github.io/images/rlShaders/rlSssNd_lucy.jpg" data-lightbox="results"><img src="http://shihchinw.github.io/images/rlShaders/rlSssNd_lucy.jpg"></a>
<figcaption>The influence of cavity.</figcaption>
</figure>

<p><a href="http://shihchinw.github.io/images/rlShaders/rlSssNd_dragon.jpg" data-lightbox="results"><img src="http://shihchinw.github.io/images/rlShaders/rlSssNd_dragon.jpg" style="max-width: 70%"></a></p>

<h1 id="references">References</h1>

<ol>
<li>Jensen, Henrik Wann, et al. <cite><a href="https://graphics.stanford.edu/papers/bssrdf/">&ldquo;A practical model for subsurface light transport.&rdquo;</a></cite> SIGGRAPH 2001.</li>
<li>Donner, Craig Steven. <cite><a href="http://www.cs.jhu.edu/~misha/Fall11/Donner.Thesis.pdf">Towards realistic image synthesis of scattering materials.</a></cite> PhD Thesis, University California, San Diego, 2006.</li>
<li>Habel, Ralf, Per H. Christensen, and Wojciech Jarosz. <cite><a href="http://graphics.pixar.com/library/PhotonBeamDiffusion/index.html">&ldquo;Classical and Improved Diffusion Theory for Subsurface Scattering.&rdquo;</a></cite> Technical Report, 2013.</li>
<li>King, Alan, et al. <cite id="ref.4"><a href="https://sites.google.com/site/ckulla/home/bssrdf-importance-sampling">&ldquo;BSSRDF importance sampling.&rdquo;</a></cite> SIGGRAPH Talks, 2013.</li>
<li>Burley, Brent. <cite id="ref.5"><a href="http://blog.selfshadow.com/publications/s2015-shading-course/">&ldquo;Extending the Disney BRDF to a BSDF with Integrated Subsurface Scattering.&rdquo;</a></cite> SIGGRAPH Course Notes, 2015.</li>
<li>Christensen, Per H., and Brent Burley. <cite id="ref.6"><a href="http://graphics.pixar.com/library/ApproxBSSRDF/index.html">&ldquo;Approximate reﬂectance profiles for efficient subsurface scattering.&rdquo;</a></cite> Technical Report 15-04, Pixar, 2015.</li>
</ol>

                  
    <hr>
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "shihchinw" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


                </div>
            </div>
        </div>
    </article>

    <hr>
    
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                  <ul class="list-inline text-center">
                    
                      <li>
                        <a href="mailto:shihchin.weng@gmail.com">
                          <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                          </span>
                        </a>
                      </li>
                    
                    
                    <li>
                      <a href="https://twitter.com/shihchinw">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="https://github.com/shihchinw">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                  </ul>
                  <p class="copyright text-muted">Copyright © Shih-Chin</p>
                </div>
            </div>
        </div>
    </footer>

    
    <script src="http://shihchinw.github.io/js/jquery.min.js"></script>

    
    <script src="http://shihchinw.github.io/js/bootstrap.min.js"></script>

    
    <script src="http://shihchinw.github.io/js/clean-blog.js"></script>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-71352938-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


    <script src="http://shihchinw.github.io/js/lightbox.js"></script>

    <script src="http://shihchinw.github.io/js/jquery.event.move.js"></script>
    <script src="http://shihchinw.github.io/js/jquery.twentytwenty.js"></script>
    

    <script>
        $(window).load(function(){
          $(".twentytwenty-container[data-orientation!='vertical']").twentytwenty({default_offset_pct: 0.7});
          $(".twentytwenty-container[data-orientation='vertical']").twentytwenty({default_offset_pct: 0.3, orientation: 'vertical'});
        });

        
        $(function() {
          return $("h1, h2, h3, h4, h5, h6").each(function(i, el) {
            var $el, icon, id;
            $el = $(el);
            id = $el.attr('id');
            icon = '<i class="fa fa-link"></i>';
            if (id) {
              return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
            }
          });
        });
    </script>
</body>

</html>

